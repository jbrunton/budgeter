<p id="notice"><%= notice %></p>

<h1>Transactions</h1>

<script>
  $(function() {
    $('.transactions form.category input').change(function() {
      var action = $(this).parent('form')[0].action + '.json';
      var data = $(this).parent('form').serialize();
      $.post(action, data);
    });
  });
</script>

<table class="transactions">
  <thead>
    <tr>
      <th class="date">Date</th>
      <th class="transaction_type">Type</th>
      <th class="description">Description</th>
      <th class="value">Value</th>
      <th class="balance">Balance</th>
      <th class="category">Category</th>
      <th class="controls" colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @transactions.each do |transaction| %>
      <tr>
        <td><%= transaction.date %></td>
        <td><%= transaction.transaction_type %></td>
        <td><%= transaction.description %></td>
        <td class="numeric"><%= currency transaction.value %></td>
        <td class="numeric"><%= currency transaction.balance %></td>
        <td>
          <%= form_with(model: transaction, remote: true, class: 'category') do |form| %>
            <%= form.text_field :category %>
          <% end %>
        </td>
        <td><%= link_to 'Show', transaction %></td>
        <td><%= link_to 'Edit', edit_transaction_path(transaction) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Transaction', new_project_transaction_path(@project) %>
